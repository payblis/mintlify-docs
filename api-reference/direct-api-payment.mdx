---
title: "Direct Api Payment"
description: "Processing Payments with Direct API Payblis intégration"
---

## Overview

<Steps>
  <Step title="1) Build the JSON body">
    Prepare the order payload and generate a \<b\>minified JSON\</b\> body.
  </Step>
  <Step title="2) Generate the HMAC signature">
    Compute X-Payblis-Signature = HMAC-SHA256(body, secret_key)
  </Step>
  <Step title="3) Send the HTTP request">
    Send the POST request using \<code\>cURL\</code\> with all required headers.
  </Step>
</Steps>

---

## Full PHP Example

<CodeGroup>

```php PHP Implementation
<?php

/**
 * CONFIGURATION
 */
$apiUrl = "https://pay.payblis.com/api/REST/create-order.php";
$merchantKey = "YOUR_API_KEY";
$secretKey  = "YOUR_SECRET_KEY";

/**
 * REQUEST BODY
 * ⚠️ The signed body MUST be exactly the same as the body sent
 */
$payload = [
    "amount" => 15,
    "RefOrder" => "ord-api-4554854",
    "Customer_Email" => "customer@example.com",
    "Customer_Name" => "Doe",
    "Customer_FirstName" => "John",
    "country" => "FR",
    "userIP" => "192.168.1.1",
    "lang" => "fr",
    "store_name" => "Example Store",
    "urlOK" => "https://pay.payblis.com/testing/success",
    "urlKO" => "https://pay.payblis.com/testing/failed",
    "ipnURL" => "https://pay.payblis.com/testing/test-ipn.php",
    "cardHolderName" => "John Doe",
    "cardno" => "4937241028091641",
    "expMonth" => "09",
    "expYear" => "2027",
    "CVN" => "445"
];

// Minified JSON (do NOT use JSON_PRETTY_PRINT)
$body = json_encode($payload, JSON_UNESCAPED_SLASHES);

/**
 * HMAC-SHA256 SIGNATURE
 */
$signature = hash_hmac("sha256", $body, $secretKey);

/**
 * HEADERS
 */
$headers = [
    "Content-Type: application/json",
    "X-Merchant-Key: " . $merchantKey,
    "X-Payblis-Signature: " . $signature
];

/**
 * cURL REQUEST
 */
$ch = curl_init($apiUrl);

curl_setopt_array($ch, [
    CURLOPT_POST => true,
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_HTTPHEADER => $headers,
    CURLOPT_POSTFIELDS => $body,
    CURLOPT_TIMEOUT => 30
]);

$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);

if ($response === false) {
    echo "cURL Error: " . curl_error($ch);
    curl_close($ch);
    exit;
}

curl_close($ch);

/**
 * RESPONSE
 */
echo "HTTP STATUS: " . $httpCode . PHP_EOL;
echo "API RESPONSE:" . PHP_EOL;
echo $response;
```

</CodeGroup>